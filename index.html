<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Biwenger data</title>
  </head>
  <body>
    <script>
      const FILE_PATH = 'data.json';
      const FILE_NAME = 'data.json';

      // Soporta /download y /cualquier-carpeta/download (ej. /Biwenger/download)
      const isDownload = window.location.pathname.replace(/\/+$/,'').endsWith('/download');

      if (isDownload) {
        // Pequeño aviso visual opcional
        document.body.textContent = 'Descargando...';

        fetch(FILE_PATH, { cache: 'no-store' })
          .then(res => res.blob())
          .then(blob => {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = FILE_NAME;
            document.body.appendChild(a);
            a.click();
            a.remove();
            URL.revokeObjectURL(url);
          })
          .catch(() => {
            // Fallback: abrir el archivo si no se pudo forzar la descarga
            window.location.href = FILE_PATH;
          });
      } else {
        // Mostrar RAW en la pantalla principal
        fetch(FILE_PATH, { cache: 'no-store' })
          .then(res => res.text())
          .then(text => {
            document.body.style.margin = "0";
            document.body.style.fontFamily = "monospace";
            document.body.textContent = text;
          })
          .catch(() => {
            document.body.textContent = 'Aún no hay data.json. Ejecuta el workflow.';
          });
      }
    </script>
  </body>
</html>